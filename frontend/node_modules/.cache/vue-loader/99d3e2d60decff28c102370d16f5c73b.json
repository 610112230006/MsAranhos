{"remainingRequest":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/natthaphongngaongam/developments/MsAranhos/frontend/src/views/import/ImportStatment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/src/views/import/ImportStatment.vue","mtime":1644292966658},{"path":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/natthaphongngaongam/developments/MsAranhos/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgQkNhcmRUZXh0LAogIEJGb3JtRmlsZSwKICBCQnV0dG9uLAogIEJGb3JtSW5wdXQsCiAgQkZvcm1Hcm91cCwKICBCRm9ybSwKICBCUm93LAogIEJGb3JtQ2hlY2tib3gsCiAgQlRhYmxlLAogIEJDb2wsCiAgQkZvcm1TZWxlY3QsCn0gZnJvbSAiYm9vdHN0cmFwLXZ1ZSI7CmltcG9ydCBYTFNYIGZyb20gInhsc3giOwppbXBvcnQgTW9kZWxDdXN0b20gZnJvbSAiLi9jb21wb25lbnQvTW9kZWxDdXN0b20udnVlIjsKaW1wb3J0IHsgVmFsaWRhdGlvblByb3ZpZGVyLCBWYWxpZGF0aW9uT2JzZXJ2ZXIgfSBmcm9tICJ2ZWUtdmFsaWRhdGUiOwppbXBvcnQgeyByZXF1aXJlZCwgZW1haWwgfSBmcm9tICJAdmFsaWRhdGlvbnMiOwppbXBvcnQgQkNhcmRDb2RlIGZyb20gIkBjb3JlL2NvbXBvbmVudHMvYi1jYXJkLWNvZGUiOwppbXBvcnQgdXNlSnd0IGZyb20gIkAvYXV0aC9qd3QvdXNlSnd0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBCQ2FyZENvZGUsCiAgICBCQ2FyZFRleHQsCiAgICBCRm9ybUZpbGUsCiAgICBCQnV0dG9uLAogICAgTW9kZWxDdXN0b20sCiAgICBCRm9ybUNoZWNrYm94LAogICAgQkZvcm1JbnB1dCwKICAgIEJGb3JtR3JvdXAsCiAgICBCRm9ybSwKICAgIEJUYWJsZSwKICAgIEJSb3csCiAgICBCQ29sLAogICAgVmFsaWRhdGlvblByb3ZpZGVyLAogICAgVmFsaWRhdGlvbk9ic2VydmVyLAogICAgQkZvcm1TZWxlY3QsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZTogbnVsbCwKICAgICAgZW5kOiAiMCIsCiAgICAgIHN0YXJ0OiAiMCIsCiAgICAgIHNlbGVjdGVkOiB0cnVlLAogICAgICBkYXRhUHJldmlldzogW10sCiAgICAgIHNoZWV0OiAiIiwKICAgICAgb2JTZWxlY3Q6IFtdLAogICAgICBmaWVsZHM6IFsKICAgICAgICAicmVxIiwKICAgICAgICAibm8iLAogICAgICAgICJUUkFOX0lEIiwKICAgICAgICAiaG4iLAogICAgICAgICJhbiIsCiAgICAgICAgInBpZCIsCiAgICAgICAgImZ1bGxuYW1lIiwKICAgICAgICAidnNkYXRlIiwKICAgICAgICAiZGNkYXRlIiwKICAgICAgICAiTUFJTklOU0NMIiwKICAgICAgICAiY2hhcmdlIiwKICAgICAgICAiaXBfYWN0IiwKICAgICAgICAiaXBBZGpSVyIsCiAgICAgICAgImlwX1BTIiwKICAgICAgICAiY29tcGVfcGVyY2VudCIsCiAgICAgICAgIkNDVUYiLAogICAgICAgICJBZGpSVyIsCiAgICAgICAgInBheV9yYXRlIiwKICAgICAgICAiY29tcGVuc2F0ZV9hY3Rfc2EiLAogICAgICAgICJjb21wZW5zYXRlX3MiLAogICAgICAgICJjb21wZW5zYXRlX3QiLAogICAgICAgICJjb21wZW5zYXRlIiwKICAgICAgXSwKICAgIH07CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgdmFsaWRhdGlvbkZvcm0oKSB7CiAgICAgIHZhciBkYXRhUHJldmlldyA9IFtdOwogICAgICB0aGlzLiRyZWZzLnNpbXBsZVJ1bGVzLnZhbGlkYXRlKCkudGhlbigoc3VjY2VzcykgPT4gewogICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZmlsZXMiLCB0aGlzLmZpbGUpOwoKICAgICAgICAgIGlmICh0aGlzLmZpbGUpIHsKICAgICAgICAgICAgdGhpcy4kc3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6ICLguYHguJnguYjguYPguIjguYHguKXguYnguKfguKvguKPguK0gPyIsCiAgICAgICAgICAgICAgdGV4dDogIuC4guC5ieC4reC4oeC4ueC4peC4guC4reC4h+C4hOC4uOC4k+C4iOC4sOC4luC4ueC4geC5gOC4nuC4tOC5iOC4oeC4peC4h+C4kOC4suC4meC4guC5ieC4reC4oeC4ueC4pSEiLAogICAgICAgICAgICAgIGljb246ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLguKLguLfguJnguKLguLHguJkiLAogICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLguKLguIHguYDguKXguLTguIEiLAogICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICBpZiAocmVzdWx0LmlzQ29uZmlybWVkKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgICAgICAgICAgICAvKiBQYXJzZSBkYXRhICovCiAgICAgICAgICAgICAgICAgIGNvbnN0IGJzdHIgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC5yZWFkKGJzdHIsIHsgdHlwZTogImJpbmFyeSIgfSk7CiAgICAgICAgICAgICAgICAgIC8qIEdldCBmaXJzdCB3b3Jrc2hlZXQgKi8KICAgICAgICAgICAgICAgICAgY29uc3Qgd3MgPSB3Yi5TaGVldHNbdGhpcy5zaGVldF07CiAgICAgICAgICAgICAgICAgIC8qIENvbnZlcnQgYXJyYXkgb2YgYXJyYXlzICovCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od3MsIHsgaGVhZGVyOiAxIH0pOwoKICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudCA9IGluZGV4ICsgMTsKICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA+PSBwYXJzZUludCh0aGlzLnN0YXJ0KSAmJgogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50IDw9IHBhcnNlSW50KHRoaXMuZW5kKQogICAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFQcmV2aWV3LnB1c2goZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YVByZXZpZXcgPSBkYXRhOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuZGF0YVByZXZpZXcgPSBkYXRhUHJldmlldwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhUHJldmlldyk7CgogICAgICAgICAgICAgICAgICB0aGlzLiRodHRwCiAgICAgICAgICAgICAgICAgICAgLnBvc3QoIi9hcGkvdjEvaW1wb3J0L3N0YXRlbWVudCIsIGRhdGFQcmV2aWV3LCB7CiAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt1c2VKd3QuZ2V0VG9rZW4oKX1gLAogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoImltcG9ydCDguILguYnguK3guKHguLnguKXguKrguLPguYDguKPguYfguIgiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICLguKrguLPguYDguKPguYfguIgiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xpZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCJpbXBvcnQg4LiC4LmJ4Lit4Lih4Li54Lil4LmE4Lih4LmI4Liq4Liz4LmA4Lij4LmH4LiIIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAi4LmE4Lih4LmI4Liq4Liz4LmA4Lij4LmH4LiIIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAiZGFuZ2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBzb2xpZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQmluYXJ5U3RyaW5nKHRoaXMuZmlsZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoIuC4geC4o+C4uOC4k+C4suC5gOC4peC4t+C4reC4geC5hOC4n+C4peC5jCIsIHsKICAgICAgICAgICAgICB0aXRsZTogYOC5hOC4oeC5iOC4quC4s+C5gOC4o+C5h+C4iGAsCiAgICAgICAgICAgICAgdmFyaWFudDogYGRhbmdlcmAsCiAgICAgICAgICAgICAgc29saWQ6IHRydWUsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgcHJldmlld0RhdGEoKSB7CiAgICAgIHZhciBkYXRhUHJldmlldyA9IFtdOwogICAgICB0aGlzLiRyZWZzLnNpbXBsZVJ1bGVzLnZhbGlkYXRlKCkudGhlbigoc3VjY2VzcykgPT4gewogICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGVzIiwgdGhpcy5maWxlKTsKCiAgICAgICAgICBpZiAodGhpcy5maWxlKSB7CiAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICAgICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHsKICAgICAgICAgICAgICAvKiBQYXJzZSBkYXRhICovCiAgICAgICAgICAgICAgY29uc3QgYnN0ciA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gucmVhZChic3RyLCB7IHR5cGU6ICJiaW5hcnkiIH0pOwogICAgICAgICAgICAgIC8qIEdldCBmaXJzdCB3b3Jrc2hlZXQgKi8KICAgICAgICAgICAgICAvLyBjb25zdCB3c25hbWUgPSB3Yi5TaGVldE5hbWVzWyLguKPguLLguKLguKXguLDguYDguK3guLXguKLguJQgSVAiXTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh3c25hbWUpCiAgICAgICAgICAgICAgY29uc3Qgd3MgPSB3Yi5TaGVldHNbdGhpcy5zaGVldF07CiAgICAgICAgICAgICAgLyogQ29udmVydCBhcnJheSBvZiBhcnJheXMgKi8KICAgICAgICAgICAgICBjb25zdCBkYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdzLCB7IGhlYWRlcjogMSB9KTsKCiAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBpbmRleCArIDE7CiAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID49IHBhcnNlSW50KHRoaXMuc3RhcnQpICYmCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA8PSBwYXJzZUludCh0aGlzLmVuZCkKICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YVByZXZpZXcucHVzaChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRhdGFQcmV2aWV3ID0gZGF0YTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5kYXRhUHJldmlldyA9IGRhdGFQcmV2aWV3OwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFQcmV2aWV3KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyh0aGlzLmZpbGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgi4LiB4Lij4Li44LiT4Liy4LmA4Lil4Li34Lit4LiB4LmE4Lif4Lil4LmMIiwgewogICAgICAgICAgICAgIHRpdGxlOiBg4LmE4Lih4LmI4Liq4Liz4LmA4Lij4LmH4LiIYCwKICAgICAgICAgICAgICB2YXJpYW50OiBgZGFuZ2VyYCwKICAgICAgICAgICAgICBzb2xpZDogdHJ1ZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlRmlsZVVwbG9hZChldmVudCkgewogICAgICB0aGlzLmZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07CgogICAgICBpZiAodGhpcy5maWxlKSB7CiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHsKICAgICAgICAgIC8qIFBhcnNlIGRhdGEgKi8KICAgICAgICAgIGNvbnN0IGJzdHIgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBjb25zdCB3YiA9IFhMU1gucmVhZChic3RyLCB7IHR5cGU6ICJiaW5hcnkiIH0pOwogICAgICAgICAgLyogR2V0IGZpcnN0IHdvcmtzaGVldCAqLwogICAgICAgICAgLy8gY29uc3Qgd3NuYW1lID0gd2IuU2hlZXROYW1lc1si4Lij4Liy4Lii4Lil4Liw4LmA4Lit4Li14Lii4LiUIElQIl07CiAgICAgICAgICBjb25zdCBzaGVldExpc3QgPSB3Yi5TaGVldE5hbWVzOyAvL0FycmF5IG9mIHNoZWV0IG5hbWVzLgogICAgICAgICAgdGhpcy5vYlNlbGVjdCA9IHNoZWV0TGlzdDsKICAgICAgICAgIGNvbnNvbGUubG9nKHNoZWV0TGlzdCk7CiAgICAgICAgICAvLyBjb25zdCB3cyA9IHdiLlNoZWV0c1t0aGlzLnNoZWV0XTsKICAgICAgICAgIC8vIGNvbnN0IGRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od3MsIHsgaGVhZGVyOiAxIH0pOwogICAgICAgIH07CiAgICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyh0aGlzLmZpbGUpOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["ImportStatment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ImportStatment.vue","sourceRoot":"src/views/import","sourcesContent":["<template>\n  <b-card-code title=\"เลือกไฟล์ Excel STATMENT จาก สปสช. ที่ต้องการนำเข้า\">\n    <b-card-text>\n      ไฟล์ Excel รูปแบบไฟล์ต้องเป็นแบบเดียวกันกับ สปสช. ทุกประการ\n    </b-card-text>\n    <div>\n      <!-- Styled -->\n      <b-form-file\n        v-model=\"file\"\n        type=\"file\"\n        ref=\"file\"\n        @change=\"handleFileUpload($event)\"\n        placeholder=\"Choose a file or drop it here...\"\n        drop-placeholder=\"Drop file here...\"\n      />\n\n      <!-- <b-card-text class=\"my-1\">\n        ไฟล์ที่เลือก : <strong>{{ file ? file.name : \"\" }}</strong>\n      </b-card-text> -->\n      <!-- <b-button variant=\"primary\" v-b-modal.modal-scrollable>\n        ตกลง\n      </b-button> -->\n      <model-custom></model-custom>\n    </div>\n    <div class=\"\">\n      <validation-observer ref=\"simpleRules\">\n        <b-form>\n          <b-form-checkbox\n            v-model=\"selected\"\n            class=\"custom-control-primary mt-2 mb-1\"\n          >\n            กำหนดแถวเอง\n          </b-form-checkbox>\n          <b-row>\n            <b-col md=\"12\">\n              <b-form-group label=\"เลือก Sheets\">\n                <b-form-select v-model=\"sheet\" :options=\"obSelect\" />\n              </b-form-group>\n            </b-col>\n          </b-row>\n          <b-row v-if=\"selected\">\n            <b-col md=\"6\">\n              <b-form-group label=\"เริ่มจาก\">\n                <validation-provider\n                  #default=\"{ errors }\"\n                  name=\"แถวที่เริ่มบันทึกข้อมูล\"\n                  rules=\"required\"\n                >\n                  <b-form-input\n                    v-model=\"start\"\n                    :state=\"errors.length > 0 ? false : null\"\n                    placeholder=\"แถวที่\"\n                  />\n                  <small class=\"text-danger\">{{ errors[0] }}</small>\n                </validation-provider>\n              </b-form-group>\n            </b-col>\n            <b-col md=\"6\">\n              <b-form-group label=\"สิ้นสุด\">\n                <validation-provider\n                  #default=\"{ errors }\"\n                  name=\"แถวที่สิ้นสุดการบันทึกข้อมูล\"\n                  rules=\"required\"\n                >\n                  <b-form-input\n                    v-model=\"end\"\n                    :state=\"errors.length > 0 ? false : null\"\n                    placeholder=\"แถวที่\"\n                  />\n                  <small class=\"text-danger\">{{ errors[0] }}</small>\n                </validation-provider>\n              </b-form-group>\n            </b-col>\n          </b-row>\n          <b-col cols=\"12\">\n            <b-button\n              variant=\"primary\"\n              type=\"submit\"\n              @click.prevent=\"validationForm\"\n            >\n              อัพโหลด\n            </b-button>\n            <b-button\n              class=\"ml-1\"\n              variant=\"secondary\"\n              @click.prevent=\"previewData\"\n            >\n               ดูตัวอย่างข้อมูล\n            </b-button>\n          </b-col>\n        </b-form>\n      </validation-observer>\n    </div>\n    <b-row class=\"mt-2\">\n      <b-col>\n        <b-table responsive :items=\"dataPreview\" class=\"mb-0\">\n        </b-table>\n      </b-col>\n    </b-row>\n  </b-card-code>\n</template>\n\n<script>\nimport {\n  BCardText,\n  BFormFile,\n  BButton,\n  BFormInput,\n  BFormGroup,\n  BForm,\n  BRow,\n  BFormCheckbox,\n  BTable,\n  BCol,\n  BFormSelect,\n} from \"bootstrap-vue\";\nimport XLSX from \"xlsx\";\nimport ModelCustom from \"./component/ModelCustom.vue\";\nimport { ValidationProvider, ValidationObserver } from \"vee-validate\";\nimport { required, email } from \"@validations\";\nimport BCardCode from \"@core/components/b-card-code\";\nimport useJwt from \"@/auth/jwt/useJwt\";\n\nexport default {\n  components: {\n    BCardCode,\n    BCardText,\n    BFormFile,\n    BButton,\n    ModelCustom,\n    BFormCheckbox,\n    BFormInput,\n    BFormGroup,\n    BForm,\n    BTable,\n    BRow,\n    BCol,\n    ValidationProvider,\n    ValidationObserver,\n    BFormSelect,\n  },\n  data() {\n    return {\n      file: null,\n      end: \"0\",\n      start: \"0\",\n      selected: true,\n      dataPreview: [],\n      sheet: \"\",\n      obSelect: [],\n      fields: [\n        \"req\",\n        \"no\",\n        \"TRAN_ID\",\n        \"hn\",\n        \"an\",\n        \"pid\",\n        \"fullname\",\n        \"vsdate\",\n        \"dcdate\",\n        \"MAININSCL\",\n        \"charge\",\n        \"ip_act\",\n        \"ipAdjRW\",\n        \"ip_PS\",\n        \"compe_percent\",\n        \"CCUF\",\n        \"AdjRW\",\n        \"pay_rate\",\n        \"compensate_act_sa\",\n        \"compensate_s\",\n        \"compensate_t\",\n        \"compensate\",\n      ],\n    };\n  },\n  mounted() {},\n  methods: {\n    validationForm() {\n      var dataPreview = [];\n      this.$refs.simpleRules.validate().then((success) => {\n        if (success) {\n          let formData = new FormData();\n          formData.append(\"files\", this.file);\n\n          if (this.file) {\n            this.$swal({\n              title: \"แน่ใจแล้วหรอ ?\",\n              text: \"ข้อมูลของคุณจะถูกเพิ่มลงฐานข้อมูล!\",\n              icon: \"warning\",\n              showCancelButton: true,\n              confirmButtonColor: \"#3085d6\",\n              cancelButtonColor: \"#d33\",\n              confirmButtonText: \"ยืนยัน\",\n              cancelButtonText: \"ยกเลิก\",\n            }).then((result) => {\n              if (result.isConfirmed) {\n                const reader = new FileReader();\n\n                reader.onload = (e) => {\n                  /* Parse data */\n                  const bstr = e.target.result;\n                  const wb = XLSX.read(bstr, { type: \"binary\" });\n                  /* Get first worksheet */\n                  const ws = wb.Sheets[this.sheet];\n                  /* Convert array of arrays */\n                  const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n\n                  if (this.selected) {\n                    data.forEach((element, index) => {\n                      var current = index + 1;\n                      if (\n                        current >= parseInt(this.start) &&\n                        current <= parseInt(this.end)\n                      ) {\n                        dataPreview.push(element);\n                      }\n                    });\n                  } else {\n                    dataPreview = data;\n                  }\n                  // this.dataPreview = dataPreview\n                  console.log(dataPreview);\n\n                  this.$http\n                    .post(\"/api/v1/import/statement\", dataPreview, {\n                      headers: {\n                        Authorization: `Bearer ${useJwt.getToken()}`,\n                      },\n                    })\n                    .then((res) => {\n                      if (res.data.status == 200) {\n                        this.$bvToast.toast(\"import ข้อมูลสำเร็จ\", {\n                          title: \"สำเร็จ\",\n                          variant: \"success\",\n                          solid: true,\n                        });\n                      } else {\n                        this.$bvToast.toast(\"import ข้อมูลไม่สำเร็จ\", {\n                          title: \"ไม่สำเร็จ\",\n                          variant: \"danger\",\n                          solid: true,\n                        });\n                      }\n                    })\n                    .catch((err) => {\n                      console.log(err);\n                    });\n                };\n                reader.readAsBinaryString(this.file);\n              }\n            });\n          } else {\n            this.$bvToast.toast(\"กรุณาเลือกไฟล์\", {\n              title: `ไม่สำเร็จ`,\n              variant: `danger`,\n              solid: true,\n            });\n          }\n        }\n      });\n    },\n    previewData() {\n      var dataPreview = [];\n      this.$refs.simpleRules.validate().then((success) => {\n        if (success) {\n          let formData = new FormData();\n\n          formData.append(\"files\", this.file);\n\n          if (this.file) {\n            const reader = new FileReader();\n\n            reader.onload = (e) => {\n              /* Parse data */\n              const bstr = e.target.result;\n              const wb = XLSX.read(bstr, { type: \"binary\" });\n              /* Get first worksheet */\n              // const wsname = wb.SheetNames[\"รายละเอียด IP\"];\n              // console.log(wsname)\n              const ws = wb.Sheets[this.sheet];\n              /* Convert array of arrays */\n              const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n\n              if (this.selected) {\n                data.forEach((element, index) => {\n                  var current = index + 1;\n                  if (\n                    current >= parseInt(this.start) &&\n                    current <= parseInt(this.end)\n                  ) {\n                    dataPreview.push(element);\n                  }\n                });\n              } else {\n                dataPreview = data;\n              }\n              this.dataPreview = dataPreview;\n              console.log(dataPreview);\n            };\n            reader.readAsBinaryString(this.file);\n          } else {\n            this.$bvToast.toast(\"กรุณาเลือกไฟล์\", {\n              title: `ไม่สำเร็จ`,\n              variant: `danger`,\n              solid: true,\n            });\n          }\n        }\n      });\n    },\n\n    handleFileUpload(event) {\n      this.file = event.target.files[0];\n\n      if (this.file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          /* Parse data */\n          const bstr = e.target.result;\n          const wb = XLSX.read(bstr, { type: \"binary\" });\n          /* Get first worksheet */\n          // const wsname = wb.SheetNames[\"รายละเอียด IP\"];\n          const sheetList = wb.SheetNames; //Array of sheet names.\n          this.obSelect = sheetList;\n          console.log(sheetList);\n          // const ws = wb.Sheets[this.sheet];\n          // const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n        };\n        reader.readAsBinaryString(this.file);\n      }\n    },\n  },\n};\n</script>\n"]}]}